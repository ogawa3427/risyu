<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>risyu</title>
    <style>
        /* ボタンに5ピクセルのマージンを追加 */
        #buttons button {
            margin: 5px;
        }
    </style>
</head>
<body>
    <h id="dateDisplay"> </h>

    <br>
    <a href="{{ url_for('aff') }}"style="margin-left: 20px;">所属設定</a><a href="{{ url_for('set') }}"style="margin-left: 20px;">高度な設定</a>

    <div id="buttons">
        <div><button class="day-button">月1</button><button class="day-button">火1</button><button class="day-button">水1</button><button class="day-button">木1</button><button class="day-button">金1</button><label><input type="checkbox" id="check1">GSのみ</label></div>
        <div><button class="day-button">月2</button><button class="day-button">火2</button><button class="day-button">水2</button><button class="day-button">木2</button><button class="day-button">金2</button><label><input type="checkbox" id="check2">教員名を省略</label></div>
        <div><button class="day-button">月3</button><button class="day-button">火3</button><button class="day-button">水3</button><button class="day-button">木3</button><button class="day-button">金3</button><label><input type="checkbox" id="check3">時間割番号を省略</label></div>
        <div><button class="day-button">月4</button><button class="day-button">火4</button><button class="day-button">水4</button><button class="day-button">木4</button><button class="day-button">金4</button><label><input type="checkbox" id="check4">優先・限定を簡略化</label></div>
        <div><button class="day-button">月5</button><button class="day-button">火5</button><button class="day-button">水5</button><button class="day-button">木5</button><button class="day-button">金5</button><label><input type="checkbox" id="check5">時間割名を省略</label></div>
        <div><button class="day-button">6限</button><button class="day-button">7限</button><button class="day-button">8限</button><button class="day-button">集中</button><select id="dropdown"><option value="0">全群</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option></select></div>
        <div><input type="text" id="freeword"><button class="day-button">ﾌﾘｰﾜｰﾄﾞ検索</button></div>
    </div>

    <table id="myTable"></table>

<script>
    console.log('HogeHoge')
    let settings = ["whonlygs", "whotea", "whono", "whrya", "whoname" ]
    let theline = "";
    let cookies = {};
    let freewordValue = "";

    function pageinit() {
        console.log("fun[PageInit]")
        //document.cookie = "role" + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC;";
        let asof = "{{ asof }}";
        let asofdisp = document.getElementById("dateDisplay");
        asofdisp.textContent = asof;
    //君は究極で完璧の
        theline = "{{ theline }}";
        console.log("theline_loaded!");

        let kidi = document.cookie; //クッキーを焼こう

        if (kidi !== "")  {
            initc = ["role=032","whonlygs=1", "whotea=0", "whono=1", "whrya=1", "whoname=0", "digree=w"];
            initc.forEach(function (item) {
                document.cookie = item;
            });
            console.log("cookie initialized!");
        }
        let kata = kidi.split('; ');
        
        for (let i = 0; i < kata.length; i++) {
            let parts = kata[i].split('=');
            cookies[parts[0]] = parts[1];
        }
        
    //SETTER
        document.getElementById("check1").checked = cookies.whonlygs == 1;
        document.getElementById("check2").checked = cookies.whotea == 1;
        document.getElementById("check3").checked = cookies.whono == 1;
        document.getElementById("check4").checked = cookies.whrya == 1;
        document.getElementById("check5").checked = cookies.whoname == 1;
    }
    
        
    function cookiereader() {
        console.log("Rfun[CoockieReader]")
        console.log(document.cookie)
        let kidi = document.cookie;
        let kata = kidi.split('; ');
        for (let i = 0; i < kata.length; i++) {
            let parts = kata[i].split('=');
            cookies[parts[0]] = parts[1];
        }
    }
    function cookiewriter() {
        console.log("Wfun[CookieWriter]")
        cookies.whonlygs = document.getElementById("check1").checked ? 1 : 0;
        cookies.whotea = document.getElementById("check2").checked ? 1 : 0;
        cookies.whono = document.getElementById("check3").checked ? 1 : 0;
        cookies.whrya = document.getElementById("check4").checked ? 1 : 0;
        cookies.whoname = document.getElementById("check5").checked ? 1 : 0;

        let expirationDate = new Date();
        expirationDate.setFullYear(expirationDate.getFullYear() + 1); // 1年後に有効期限を設定
        let expires = "expires=" + expirationDate.toUTCString();

        for (let [key, value] of Object.entries(cookies)) {
            document.cookie = `${key}=${value}; ${expires}; path=/`;
        }

        console.log(document.cookie)
    }

    function handleButtonClick(event) {
        let buttonText = event.target.textContent;
        let freewordValue = document.getElementById("freeword").value;
        let whonlygs = document.getElementById("check1").checked;
        let whotea = document.getElementById("check2").checked;
        let whono = document.getElementById("check3").checked;
        let whrya = document.getElementById("check4").checked;
        let whoname = document.getElementById("check5").checked;
        let rowgun = document.getElementById("dropdown").value;

        console.log(buttonText)
        cookiewriter()
        console.log(cookies);
    }


    window.onload = function() {
        // すべての.day-buttonを取得
        let buttons = document.querySelectorAll(".day-button");

        // 各ボタンにクリックイベントリスナーを追加
        buttons.forEach(function(button) {
            button.addEventListener("click", handleButtonClick);
        });
    }



    document.addEventListener("DOMContentLoaded", pageinit);
    

</script>

</body>
</html>